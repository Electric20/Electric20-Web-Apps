<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <!--[if IE]><script language="javascript" type="text/javascript" src="flot/excanvas.min.js"></script><![endif]--> 
  <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
  <script type="text/javascript" src="js/flot2/jquery.flot.js"></script>
  <script type="text/javascript" src="js/flot2/jquery.flot.stack.js"></script>


<script type="text/javascript">
var finalData = new Array;
function plotChart () {
    var css_id = "#placeholder";
    var data = finalData;
    var options = {
        series: {stack: 0,
                 lines: {show: false, steps: false },
                 bars: {show: true, barWidth: 0.9, align: 'center',},},
        xaxis: {	min: 0,
	 				max:23,
					ticks: [[0,'00:00'], [1,'01:00'], [2,'02:00'], [3,'03:00'], [4,'04:00'], [5,'05:00'], [6,'06:00'], [7,'07:00'], [8,'08:00'], [9,'09:00'], [10,'10:00'], [11,'11:00'], [12,'12:00'], [13,'13:00'], [14,'14:00'], [15,'15:00'], [16,'16:00'], [17,'17:00'], [18,'18:00'], [19,'19:00'], [20,'20:00'], [21,'21:00'], [22,'22:00'], [23,'23:00']]},
    };

    $.plot($(css_id), data, options);
}

var graphData = new Object();

$.getJSON('barChartData.php?dater=' + '2011-08-05' +'&uid=' + '0', function(data)
{
	for(var i = 0; i< data.data.length; i++)
	{
		if(!graphData[data.data[i].desc])
		{
			graphData[data.data[i].desc] = new Object();
			graphData[data.data[i].desc].data = new Array();
			graphData[data.data[i].desc].label = data.data[i].desc;
		}
		graphData[data.data[i].desc].data.push(new Array(data.data[i].i, data.data[i].cons));
	}
	for(x in graphData)
	{
		finalData.push(graphData[x]);
	}
	plotChart();
});


</script>
  <title>Flot stacked bar example</title>
</head>
<body>
  <div id="placeholder" style="width:100%;height:200px;"></div>
</body>
</html>
